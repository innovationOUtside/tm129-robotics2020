
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2 Dead reckoning &#8212; TM129 Robotics Practical Activities</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e8e5499552300ddf5d7adccae7cc3b70.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3 Emergent robot behaviour and simple data charts" href="04.3%20Emergent%20robot%20behaviour%20and%20simple%20data%20charts.html" />
    <link rel="prev" title="1 Introduction to functions and robot control strategies" href="04.1%20Introducing%20program%20functions.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      <h1 class="site-logo" id="site-title">TM129 Robotics Practical Activities</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../README_FIRST.html">
   Welcome to the TM129 Robotics block
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../00_FOR_VLE/Section_00_01_Introduction.html">
   1 Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../00_NOTES_FOR_TUTORS/GETTING_STARTED.html">
   Getting started
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01.%20Introducing%20notebooks%20and%20the%20RoboLab%20environment/01.1%20Jupyter%20environment.html">
   1 Introduction to the TM129 Jupyter notebook environment
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01.%20Introducing%20notebooks%20and%20the%20RoboLab%20environment/01.2%20Exploring%20the%20notebook%20environment.html">
     2 The interactive read-writable notebook environment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01.%20Introducing%20notebooks%20and%20the%20RoboLab%20environment/01.3%20Introducing%20nbev3devsim.html">
     3 The RoboLab simulated on-screen robot (
     <code class="docutils literal notranslate">
      <span class="pre">
       nbev3devsim
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01.%20Introducing%20notebooks%20and%20the%20RoboLab%20environment/01.4%20Exploring%20nbev3devsim.html">
     4 Exploring the
     <code class="docutils literal notranslate">
      <span class="pre">
       nbev3devsim
      </span>
     </code>
     simulator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01.%20Introducing%20notebooks%20and%20the%20RoboLab%20environment/01.5%20Example%20robot%20program.html">
     5 An example robot program
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01.%20Introducing%20notebooks%20and%20the%20RoboLab%20environment/01.6%20Working%20With%20Simulators.html">
     6 Working with simulators
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02.%20Getting%20started%20with%20robot%20and%20Python%20programming/02.1%20Robot%20programming%20constructs.html">
   1 An introduction to programming robots
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02.%20Getting%20started%20with%20robot%20and%20Python%20programming/02.2%20Creating%20your%20own%20robot%20programs.html">
     2 Creating your own robot programs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02.%20Getting%20started%20with%20robot%20and%20Python%20programming/02.3%20General%20programming%20concepts.html">
     3.1 Constants and variables in programs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02.%20Getting%20started%20with%20robot%20and%20Python%20programming/02.4%20Getting%20started%20with%20sensors.html">
     4 Robot sensors and data logging
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03.%20Controlling%20program%20execution%20flow/03.1%20Program%20control%20using%20for%20loops.html">
   1 Introduction to program control flow
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03.%20Controlling%20program%20execution%20flow/03.2%20Program%20control%20using%20while%20loops%20and%20blocking.html">
     2 Program control flow using a
     <code class="docutils literal notranslate">
      <span class="pre">
       while...
      </span>
     </code>
     loop
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03.%20Controlling%20program%20execution%20flow/03.3%20Program%20control%20flow%20using%20branches.html">
     3 Branches
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03.%20Controlling%20program%20execution%20flow/03.4%20Example%20robot%20control%20programs.html">
     4 Example robot control programs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03.%20Controlling%20program%20execution%20flow/03.5%20Some%20RoboLab%20challenges.html">
     5 RoboLab challenges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03.%20Controlling%20program%20execution%20flow/03.6%20Optional%20RoboLab%20challenges.html">
     6 Optional challenges
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="04.1%20Introducing%20program%20functions.html">
   1 Introduction to functions and robot control strategies
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     2 Dead reckoning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04.3%20Emergent%20robot%20behaviour%20and%20simple%20data%20charts.html">
     3 Emergent robot behaviour and simple data charts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04.4%20Reasoning%20with%20Eliza.html">
     4 Reasoning with Eliza
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04.5%20Reasoning%20with%20rule%20based%20systems.html">
     5 Reasoning with rule-based systems – Durable Rules Engine
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05.%20Experimenting%20with%20sensors/05.1%20Introducing%20sensor%20based%20control.html">
   Introduction to sensor-based control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06.%20Where%20in%20the%20world%20are%20we/06.1%20Introducing%20sensor%20based%20navigation.html">
   Introducing sensor-based navigation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07.%20Neural%20networks/07.1%20Introducing%20neural%20networks.html">
   1 Introducing neural networks
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../08.%20Remote%20services%20and%20multi-agent%20systems/08.1%20Introducing%20remote%20services%20and%20multi-agent%20systems.html">
   1 An introduction to remote services and multi-agent systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../08.%20Remote%20services%20and%20multi-agent%20systems/08.2%20Collecting%20digit%20image%20and%20class%20data%20from%20the%20simulator.html">
     2 Collecting digit image and class data from the simulator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08.%20Remote%20services%20and%20multi-agent%20systems/08.3%20Recognising%20digits%20using%20a%20convolutional%20neural%20network%20%28optional%29.html">
     3 Recognising digits using a convolutional neural network (optional)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08.%20Remote%20services%20and%20multi-agent%20systems/08.4%20Recognising%20patterns%20on%20the%20move.html">
     4 Recognising patterns on the move
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08.%20Remote%20services%20and%20multi-agent%20systems/08.5%20Messaging%20in%20multi-agent%20systems.html">
     5 Messaging in multi-agent systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08.%20Remote%20services%20and%20multi-agent%20systems/08.6%20Conclusion.html">
     6 Conclusion
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/04. Not quite intelligent robots/04.2 Robot navigation using dead reckoning.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/04. Not quite intelligent robots/04.2 Robot navigation using dead reckoning.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#activity-dead-reckoning">
   2.1 Activity – Dead reckoning
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-motor-tacho-counts-to-identify-how-far-the-robot-has-travelled">
     2.1.1 Using motor tacho counts to identify how far the robot has travelled
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#activity-dead-reckoning-over-distances-optional">
     2.1.2 Activity – Dead reckoning over distances (optional)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#challenge-reaching-the-moon-base">
   2.2 Challenge – Reaching the moon base
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dead-reckoning-with-noise">
   2.3 Dead reckoning with noise
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   2.4 Summary
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="dead-reckoning">
<h1>2 Dead reckoning<a class="headerlink" href="#dead-reckoning" title="Permalink to this headline">¶</a></h1>
<p><em>Dead reckoning</em> is a means of navigation that does not rely on external observations. Instead, a robot’s position is estimated by summing its incremental movements relative to a known starting point.</p>
<p>Estimates of the distance traversed are usually obtained from measuring how many times the wheels have turned, and how many times they have turned in relation to each other. For example, the wheels of the robot could be attached to an odometer, similar to the device that records the mileage of a car.</p>
<p>In RoboLab we will calculate the position of a robot from how long it moves in a straight line or rotates about its centre. We will assume that the length of time for which the motors are switched on is directly related to the distance travelled by the wheels.</p>
<p><em>By design, the simulator does not provide the robot with access to any magical GPS-style service. In principle, we could create a magical ‘simulated-GPS’ sensor that would allow the robot to identify its location from the simulator’s point of view; but in the real world we can’t always guarantee that external location services are available. For example, GPS doesn’t work indoors or underground, or even in many cities where line-of-sight access to four or more GPS satellites is not available.</em></p>
<p><em>Furthermore, the robot cannot magically teleport itself to a new location from within a program. Only the magics can teleport the robot to a specific location…</em></p>
<p><em>Although the simulator is omniscient and does keep track of where the robot is, the robot must figure out for itself where it is based on things like how far the motors have turned, or from its own sensor readings (ultrasound-based distance to a target, for example, or gyroscope heading); you will learn how to make use of sensors for navigation in later notebooks.</em></p>
<div class="section" id="activity-dead-reckoning">
<h2>2.1 Activity – Dead reckoning<a class="headerlink" href="#activity-dead-reckoning" title="Permalink to this headline">¶</a></h2>
<p>An environment for the simulated robot to navigate is shown below, based on the 2018 First Lego League ‘Into Orbit’ challenge.</p>
<p>The idea is that the robot must get to the target satellite from its original starting point by avoiding the obstacles in its direct path.</p>
<p><img alt="Space scene showing the robot, some satellites against a ‘space’ background, and some wall-like obstacles between the robot’s starting point and a target satellite." src="../_images/Section_00_02_-_Jupyter_Notebook.png" /></p>
<p>The <a class="reference external" href="https://www.firstlegoleague.org/">First Lego League (FLL)</a> is a friendly international youth-based robot competition in which teams compete at national and international level on an annual basis. School teams are often coached by volunteers. In the UK, volunteers often coach teams under the auspices of the <a class="reference external" href="https://www.stem.org.uk/stem-ambassadors">STEM Ambassadors Scheme</a>. Many companies run volunteering schemes that allow employees to volunteer their skills in company time using schemes such as STEM Ambassadors.</p>
<p>Load in the simulator in the usual way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nbev3devsim.load_nbev3devwidget</span> <span class="kn">import</span> <span class="n">roboSim</span><span class="p">,</span> <span class="n">eds</span>

<span class="o">%</span><span class="n">load_ext</span> <span class="n">nbev3devsim</span>
</pre></div>
</div>
</div>
</div>
<p>To navigate the environment, we will use a small robot configuration within the simulator. The robot configuration can be set via the simulator user interface, or by passing the <code class="docutils literal notranslate"><span class="pre">-r</span> <span class="pre">Small_Robot</span></code> parameter setting in the simulator magic.</p>
<p>The following program should drive the robot from its starting point to the target, whilst avoiding the obstacles. We define the obstacle as being avoided if it is not crossed by the robot’s <em>pen down</em> trail.</p>
<p>Load the <em>FLL_2018_Into_Orbit</em> background into the simulator. Run the following code cell to download the program to the simulator and then, with the <em>pen down</em>, run the program in the simulator.</p>
<p>Remember, you can use the <code class="docutils literal notranslate"><span class="pre">-P</span> <span class="pre">/</span> <span class="pre">--pencolor</span></code> flag to change the pen colour and the <code class="docutils literal notranslate"><span class="pre">-C</span> <span class="pre">/</span> <span class="pre">--clear</span></code> option to clear the pen trace.</p>
<p>Does the robot reach the target satellite without encountering any obstacles?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">sim_magic_preloaded</span> <span class="o">-</span><span class="n">b</span> <span class="n">FLL_2018_Into_Orbit</span> <span class="o">-</span><span class="n">p</span> <span class="o">-</span><span class="n">r</span> <span class="n">Small_Robot</span>

<span class="c1"># Turn on the spot to the right</span>
<span class="n">tank_turn</span><span class="o">.</span><span class="n">on_for_rotations</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">70</span><span class="p">),</span> <span class="mf">1.7</span> <span class="p">)</span>

<span class="c1"># Go forwards</span>
<span class="n">tank_drive</span><span class="o">.</span><span class="n">on_for_rotations</span><span class="p">(</span><span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Slight graceful turn to left</span>
<span class="n">tank_drive</span><span class="o">.</span><span class="n">on_for_rotations</span><span class="p">(</span><span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">35</span><span class="p">),</span> <span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="mf">8.5</span><span class="p">)</span>

<span class="c1"># Turn on the spot to the left</span>
<span class="n">tank_turn</span><span class="o">.</span><span class="n">on_for_rotations</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">75</span><span class="p">),</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="c1"># Forwards a bit</span>
<span class="n">tank_drive</span><span class="o">.</span><span class="n">on_for_rotations</span><span class="p">(</span><span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="mf">2.0</span><span class="p">)</span>

<span class="c1"># Turn on the spot a bit more to the right</span>
<span class="n">tank_turn</span><span class="o">.</span><span class="n">on_for_rotations</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span> <span class="mf">0.4</span> <span class="p">)</span>

<span class="c1"># Go forwards a bit more and dock on the satellite</span>
<span class="n">tank_drive</span><span class="o">.</span><span class="n">on_for_rotations</span><span class="p">(</span><span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="n">say</span><span class="p">(</span><span class="s2">&quot;Hopefully I have docked with the satellite...&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><em>Add your notes on how well the simulated robot performed the task here.</em></p>
<p>To set the speeds and times, I used a bit of trial and error.</p>
<p>If the route had been much more complex, then I would have been tempted to comment out the steps up I had already run and add new steps that would be applied from wherever the robot was currently located.</p>
<p>Note that the robot could have taken other routes to get to the satellite – I just thought I should avoid the asteroid!</p>
<div class="section" id="using-motor-tacho-counts-to-identify-how-far-the-robot-has-travelled">
<h3>2.1.1 Using motor tacho counts to identify how far the robot has travelled<a class="headerlink" href="#using-motor-tacho-counts-to-identify-how-far-the-robot-has-travelled" title="Permalink to this headline">¶</a></h3>
<p>In the above example, the motors were turned on for a specific amount of time to move the robot on each leg of its journey. This would not be an appropriate control strategy if we wanted to collect sensor data along the route, because the <code class="docutils literal notranslate"><span class="pre">on_for_X()</span></code> motor commands are blocking commands.</p>
<p>However, suppose we replaced the forward driving <code class="docutils literal notranslate"><span class="pre">tank_drive.on_for_rotations()</span></code> commands with commands of the form:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>

<span class="n">tank_drive</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">SPEED</span><span class="p">)</span>
<span class="k">while</span> <span class="nb">int</span><span class="p">(</span><span class="n">tank_drive</span><span class="o">.</span><span class="n">left_motor</span><span class="o">.</span><span class="n">position</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">DISTANCE</span><span class="p">:</span>
    <span class="c1"># We need something that takes a finite time</span>
    <span class="c1"># to run in the loop or the program will hang</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we could drive the robot forwards until the motor tacho count exceeds a specified <code class="docutils literal notranslate"><span class="pre">DISTANCE</span></code> and at the same time, optionally include additional commands, such as sensor data-logging commands, inside the body of each <code class="docutils literal notranslate"><span class="pre">while</span></code> loop.</p>
<p><em>As well as <code class="docutils literal notranslate"><span class="pre">tank_drive.left_motor.position</span></code> we can also refer to <code class="docutils literal notranslate"><span class="pre">tank_drive.right_motor.position</span></code>. Also note that these values are returned as strings and need to be cast to integers for numerical comparisons.</em></p>
</div>
<div class="section" id="activity-dead-reckoning-over-distances-optional">
<h3>2.1.2 Activity – Dead reckoning over distances (optional)<a class="headerlink" href="#activity-dead-reckoning-over-distances-optional" title="Permalink to this headline">¶</a></h3>
<p>Use the <code class="docutils literal notranslate"><span class="pre">.left_motor.position</span></code> and/or <code class="docutils literal notranslate"><span class="pre">.right_motor.position</span></code> motor tacho counts in a program that allows the robot to navigate from its home base to the satellite rendezvous.</p>
<p><em>Your design notes here.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
<p><em>Your notes and observations here.</em></p>
</div>
</div>
<div class="section" id="challenge-reaching-the-moon-base">
<h2>2.2 Challenge – Reaching the moon base<a class="headerlink" href="#challenge-reaching-the-moon-base" title="Permalink to this headline">¶</a></h2>
<p>In the following code cell, write a program to move the simulated robot from its location servicing the satellite to the moon base identified as the circular area marked on the moon in the top right-hand corner of the simulated world.</p>
<p>In the simulator, set the robot’s <em>x</em> location to <code class="docutils literal notranslate"><span class="pre">1250</span></code> and <em>y</em> location to <code class="docutils literal notranslate"><span class="pre">450</span></code>.</p>
<p>Use the following code cell to write your own dead-reckoning program to drive the robot to the moon base at location <code class="docutils literal notranslate"><span class="pre">(2150,</span> <span class="pre">950)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">sim_magic_preloaded</span>

<span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dead-reckoning-with-noise">
<h2>2.3 Dead reckoning with noise<a class="headerlink" href="#dead-reckoning-with-noise" title="Permalink to this headline">¶</a></h2>
<p>The robot traverses its path using timing information for dead reckoning. In principle, if the simulated robot had a map then it could calculate all the distances and directions for itself, convert these to times, and dead reckon its way to the target. However, there is a problem with dead reckoning: <em>noise</em>.</p>
<p>In many physical systems, a perfect intended behaviour is subject to <em>noise</em> – random perturbations that arise within the system as time goes on as a side effect of its operation. In a robot, noise might arise in the behaviour of the motors, the transmission or the wheels. The result is that the robot does not execute its motion without error. We can model noise effects in the mobility system of our robot by adding a small amount of noise to the motor speeds as the simulator runs. This noise component may speed up or slow down the speed of each motor, in a random way. As with real systems, the noise represents slight random deviations from the theoretical, ideal behaviour.</p>
<p>For the following experiment, create a new, empty background cleared of pen traces.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">sim_magic</span> <span class="o">-</span><span class="n">b</span> <span class="n">Empty_Map</span> <span class="o">--</span><span class="n">clear</span>
</pre></div>
</div>
</div>
</div>
<p>Run the following code cell to download the program to the simulator using an empty background (select the <em>Empty_Map</em>) and the <em>Pen Down</em> mode selected. Also reset the initial location of the robot to an <em>x</em> value of <code class="docutils literal notranslate"><span class="pre">150</span></code> and <em>y</em> value of <code class="docutils literal notranslate"><span class="pre">400</span></code>.</p>
<p>Run the program in the simulator and observe what happens.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">sim_magic_preloaded</span> <span class="o">-</span><span class="n">b</span> <span class="n">Empty_Map</span> <span class="o">-</span><span class="n">p</span> <span class="o">-</span><span class="n">x</span> <span class="mi">150</span> <span class="o">-</span><span class="n">y</span> <span class="mi">400</span> <span class="o">-</span><span class="n">r</span> <span class="n">Small_Robot</span> <span class="o">--</span><span class="n">noisecontrols</span>


<span class="n">tank_drive</span><span class="o">.</span><span class="n">on_for_rotations</span><span class="p">(</span><span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>
                            <span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><em>Record your observations here describing what happens when you run the program.</em></p>
<p>When you run the program, you should see the robot drive forwards a short way in a straight line, leaving a straight line trail behind it.</p>
<p>Reset the location of the robot. Within the simulator, use the <em>Noise controls</em> to increase the <em>Wheel noise</em> value from zero by dragging the slider to the right a little way. Alternatively, add noise in the range <code class="docutils literal notranslate"><span class="pre">0...500</span></code> using the <code class="docutils literal notranslate"><span class="pre">--motornoise</span> <span class="pre">/</span> <span class="pre">-M</span></code> magic flag.</p>
<p>Run the program in the simulator again.</p>
<p>You should notice this time that the robot does not travel in a straight line. Instead, it drifts from side to side, although possibly to one side of the line.</p>
<p>Move the robot back to the start position, or rerun the previous code cell to do so, and run the program in the simulator again. This time, you should see it follows yet another different path.</p>
<p>Depending on how severe the noise setting is, the robot will travel closer (low noise) to the original straight line, or follow an ever-more erratic path (high noise).</p>
<p><em>Record your own notes and observations here describing the behaviour of the robot for different levels of motor noise.</em></p>
<p>Clear the pen traces from the simulator by running the following line magic:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">sim_magic</span> <span class="o">-</span><span class="n">C</span>
</pre></div>
</div>
</div>
</div>
<p>Now run the original satellite-finding dead-reckoning program again, using the <em>FLL_2018_Into_Orbit</em> background, but in the presence of <em>Wheel noise</em>. How well does it perform this time compared to previously?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">sim_magic_preloaded</span> <span class="o">-</span><span class="n">b</span> <span class="n">FLL_2018_Into_Orbit</span> <span class="o">-</span><span class="n">p</span> <span class="o">-</span><span class="n">r</span> <span class="n">Small_Robot</span>

<span class="c1"># Turn on the spot to the right</span>
<span class="n">tank_turn</span><span class="o">.</span><span class="n">on_for_rotations</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">70</span><span class="p">),</span> <span class="mf">1.7</span> <span class="p">)</span>

<span class="c1"># Go forwards</span>
<span class="n">tank_drive</span><span class="o">.</span><span class="n">on_for_rotations</span><span class="p">(</span><span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Slight graceful turn to left</span>
<span class="n">tank_drive</span><span class="o">.</span><span class="n">on_for_rotations</span><span class="p">(</span><span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">35</span><span class="p">),</span> <span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="mf">8.5</span><span class="p">)</span>

<span class="c1"># Turn on the spot to the left</span>
<span class="n">tank_turn</span><span class="o">.</span><span class="n">on_for_rotations</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">75</span><span class="p">),</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="c1"># Forwards a bit</span>
<span class="n">tank_drive</span><span class="o">.</span><span class="n">on_for_rotations</span><span class="p">(</span><span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="mf">2.0</span><span class="p">)</span>

<span class="c1"># Turn on the spot a bit more to the right</span>
<span class="n">tank_turn</span><span class="o">.</span><span class="n">on_for_rotations</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span> <span class="mf">0.4</span> <span class="p">)</span>

<span class="c1"># Go forwards a bit more and dock on the satellite</span>
<span class="n">tank_drive</span><span class="o">.</span><span class="n">on_for_rotations</span><span class="p">(</span><span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">SpeedPercent</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="n">say</span><span class="p">(</span><span class="s2">&quot;Did I avoid crashing and dock with the satellite?&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Reset the robot to its original location and run the program in the simulator again. Even with the same level of motor noise as on the previous run, how does the path followed by the robot this time compare with the previous run?</p>
<p><em>Add your own notes and observations here.</em></p>
</div>
<div class="section" id="summary">
<h2>2.4 Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>In this notebook, you have seen how we can use dead reckoning to move the robot along a specified path. Using the robot’s motor speeds and by monitoring how long the motors are switched on for, we can use distance–time calculations to estimate the robot’s path. If we add in accurate measurements regarding how far we want the robot to travel, and in what direction, this provides one way of helping the robot to navigate to a particular waypoint.</p>
<p>However, in the presence of noise, this approach is likely to be very unreliable: whilst the robot may think it is following one path, as determined by how long it has turned its motors on, and at what speed, it may in fact be following another path. In a real robot, the noise may be introduced in all sorts of ways, including from friction in the motor bearings, the time taken to accelerate from a standing start and get up to speed, and loss of traction effects such as wheel spin and slip as the robot’s wheels turn.</p>
<p>Whilst in some cases it may reach the target safely, in others it may end somewhere completely different, or encounter an obstacle along the way.</p>
<!-- JD: should we say what's coming up in the next notebook? --></div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./04. Not quite intelligent robots"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="04.1%20Introducing%20program%20functions.html" title="previous page">1 Introduction to functions and robot control strategies</a>
    <a class='right-next' id="next-link" href="04.3%20Emergent%20robot%20behaviour%20and%20simple%20data%20charts.html" title="next page">3 Emergent robot behaviour and simple data charts</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>